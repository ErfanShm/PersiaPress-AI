# ğŸ“„ PersiaPress AI

Automate your WordPress workflow: Generate Persian blog posts from English sources using AI and publish drafts instantly.

## ğŸ› ï¸ Technology Stack

[![Python](https://img.shields.io/badge/Python-3.11-blue.svg)](https://python.org)
[![Streamlit](https://img.shields.io/badge/Streamlit-1.28.0-red.svg)](https://streamlit.io)
[![LangChain](https://img.shields.io/badge/LangChain-0.3.25-orange.svg)](https://langchain.com)
[![OpenAI](https://img.shields.io/badge/OpenAI-API-green.svg)](https://openai.com)
[![Google AI](https://img.shields.io/badge/Google_AI-Gemini-blue.svg)](https://ai.google.dev)
[![WordPress](https://img.shields.io/badge/WordPress-REST_API-blue.svg)](https://wordpress.org)
[![Rank Math](https://img.shields.io/badge/Rank_Math-SEO-orange.svg)](https://rankmath.com)
[![Pantry Cloud](https://img.shields.io/badge/Pantry_Cloud-Async-purple.svg)](https://getpantry.cloud)
[![Markdown](https://img.shields.io/badge/Markdown-HTML-black.svg)](https://markdown.com)
[![JSON](https://img.shields.io/badge/JSON-Data_Storage-yellow.svg)](https://json.org)

## ğŸŒŸ Project Overview

The PersiaPress AI project is a Streamlit-based web application designed to automate and streamline the creation of Persian blog content for WordPress from English source material.

**Main Purpose & Problem Solved:**
The primary goal of PersiaPress AI is to simplify and accelerate the process of generating engaging Persian blog posts for the `hooshews.com` WordPress site. It addresses the challenge of manually translating, adapting, and optimizing content for a Persian audience, a task that can be time-consuming and require significant effort. It also aims to enhance collaboration among content creators by providing a centralized platform with cloud-synchronized outputs.

**Key Features & Functionalities (High-Level):**
*   **AI-Powered Content Generation:** Leverages Large Language Models (LLMs) to generate a comprehensive package from English source articles. This includes a Persian blog post (translated and SEO-optimized), title, slug, meta description, image alt text, focus keywords, and tags. It also generates social media content like Instagram posts/stories and image prompts (both artistic and realistic styles).
*   **Advanced SEO Optimization:** Implements comprehensive SEO strategies including E-E-A-T (Experience, Expertise, Authoritativeness, Trustworthiness), semantic keyword integration, strategic keyword placement, and modern SEO best practices for high Rank Math scores.
*   **Persian Localization:** Specialized for Iranian audience with cultural references, Persian idioms, voice search optimization, and mobile-first design considerations.
*   **WordPress Integration:** Directly interacts with the WordPress REST API to automate the creation of draft posts. This includes uploading featured images and managing tags.
*   **Dual Save & Load Capabilities:**
    *   **Local Storage:** Saves all generated content as JSON files in a local `answers/` directory.
    *   **Pantry Cloud Integration:** Optionally saves and loads content to/from Pantry Cloud, enabling easy sharing and access across a team. These cloud operations are performed asynchronously.
*   **Collaboration Support:** Generated files and Pantry Cloud basket names are prefixed with the user's WordPress username (`WP_USERNAME`), making it easier to identify and manage content in a team environment.
*   **User-Friendly Web Interface:** Utilizes Streamlit to provide an interactive interface for inputting source article details, uploading images, initiating content generation, loading previous work, and publishing to WordPress.
*   **Content Processing:** Includes features like converting generated Markdown content to HTML for WordPress compatibility.
*   **Image Generation:** Creates optimized image prompts for blog thumbnails, Instagram posts, and social media content with brand authenticity and news relevance.

**Target User:**
The application is targeted towards content creators, bloggers, digital marketers, or editorial teams who manage a Persian-language WordPress website and wish to efficiently repurpose English content using AI. The features facilitating team collaboration (cloud storage, username prefixing) imply its suitability for small to medium-sized content teams.

---

## ğŸ—‚ï¸ File Structure

```
.
â”œâ”€â”€ .env                       # Environment variables (manually filled by user)
â”œâ”€â”€ .env.tmp                   # Template for environment variables
â”œâ”€â”€ .gitignore                 # Specifies files/directories to be ignored by Git
â”œâ”€â”€ pyproject.toml             # Project metadata and dependencies (managed by uv)
â”œâ”€â”€ uv.lock                    # Locked dependency versions for reproducible builds (generated by uv)
â”œâ”€â”€ README.md                  # Project overview and documentation
â”œâ”€â”€ run.bat                    # Windows batch script to launch the Streamlit application
â”œâ”€â”€ answers/                   # Stores AI-generated content outputs (JSON files)
â”œâ”€â”€ app/                       # Main application package
â”‚   â”œâ”€â”€ __init__.py            # Initializes the Python package
â”‚   â”œâ”€â”€ app.py                 # Main entry point for the Streamlit web application
â”‚   â”œâ”€â”€ ui.py                  # Defines the Streamlit user interface components
â”‚   â”œâ”€â”€ content_generator.py   # Logic for AI-driven content generation
â”‚   â”œâ”€â”€ llm_clients.py         # Manages LLM client initialization and configuration
â”‚   â”œâ”€â”€ wordpress_handler.py   # Handles interactions with the WordPress REST API
â”‚   â”œâ”€â”€ file_utils.py          # Utility functions for file operations and data persistence
â”‚   â”œâ”€â”€ utils.py               # Miscellaneous helper functions
â”‚   â””â”€â”€ prompts/               # Directory for LLM prompt templates (text files)
â”‚       â”œâ”€â”€ system_prompt_blog_generation.txt      # Enhanced system prompt with E-E-A-T focus
â”‚       â”œâ”€â”€ human_prompt_blog_generation.txt       # Comprehensive human prompt with SEO opt
â”‚       â”œâ”€â”€ blog_thumbnail_image_prompt.txt        # Minimal, clean image prompts
â”‚       â”œâ”€â”€ realistic_thumbnail_image_prompt.txt   # Realistic image prompts
â”‚       â”œâ”€â”€ instagram_static_image_prompt.txt      # Instagram static image prompts
â”‚       â”œâ”€â”€ instagram_video_ready_image_prompt.txt # Instagram video image prompts
â”‚       â”œâ”€â”€ instagram_video_prompt.txt             # Instagram video content prompts
â”‚       â”œâ”€â”€ system_prompt_instagram_texts.txt      # Instagram text generation system prompt
â”‚       â”œâ”€â”€ human_prompt_instagram_texts.txt       # Instagram text generation human prompt
â”‚       â”œâ”€â”€ system_prompt_analyze_blog.txt         # Blog analysis system prompt
â”‚       â”œâ”€â”€ human_prompt_analyze_blog.txt          # Blog analysis human prompt
â”‚       â”œâ”€â”€ system_prompt_instagram_story_teasers.txt # Story teaser system prompt
â”‚       â””â”€â”€ human_prompt_instagram_story_teasers.txt  # Story teaser human prompt
â”œâ”€â”€ images/                    # Stores temporary thumbnail images uploaded by the user
â””â”€â”€ plugins/                   # Contains WordPress plugins
    â””â”€â”€ Rank-Math-Api-Manager/ # Custom plugin for Rank Math SEO API integration
        â””â”€â”€ rank-math-api-manager-extended-v1.3.php
```

---

## ğŸš€ Features

*   **Source Input:** Accepts English source article title, body, source name, and URL.
*   **Advanced LLM Content Package Generation:** 
    *   Generates Persian Title, English Slug, Persian Content (Markdown), Meta Description, Alt Text, Focus Keywords, SEO Title, English/Persian Tags
    *   Instagram Post/Story content with Persian localization
    *   Image Prompts (minimal, clean, realistic, and artistic styles)
    *   E-E-A-T optimized content with authoritative sources
    *   Semantic keyword integration with natural language flow
*   **SEO Optimization:**
    *   Strategic keyword placement (H1, meta description, first paragraph, H2 headings)
    *   Content freshness indicators and schema markup suggestions
    *   External linking to authoritative sources (2-3 dofollow links)
    *   Image optimization with proper alt text and filenames
    *   Table of contents for long articles (1500+ words)
    *   Mobile-first responsive design considerations
*   **Persian Localization:**
    *   Cultural references and Persian idioms
    *   Voice search optimization for Persian queries
    *   Local news trends and Iranian tech context
    *   Persian numerals and proper grammar
*   **Dual Data Persistence & Loading:**
    *   Saves all generated data (including raw LLM outputs and final package) to local JSON files in `answers/`.
    *   Optionally saves the same data to Pantry Cloud if `PANTRY_ID` is configured.
    *   Filenames and Pantry basket names are prefixed with the `WP_USERNAME` for team traceability.
    *   Allows loading data from local files via `st.file_uploader`.
    *   Allows fetching a list of baskets from Pantry Cloud and loading selected data.
*   **Asynchronous Pantry Operations:** All interactions with Pantry Cloud (saving, listing baskets, getting basket content) are performed asynchronously using `aiohttp`.
*   **WordPress Post Creation Workflow:** (As previously described, including Markdown to HTML, tag handling, image upload, Rank Math attempt).
*   **Local Image Handling:** (As previously described).

---

## ğŸ”„ Application Workflow

The PersiaPress AI application follows a user-driven workflow, orchestrated by the Streamlit interface defined in `app/ui.py`.

**1. Initialization and LLM Client Setup:**
*   When the user launches the application (`streamlit run app/app.py`), the `main()` function in `app/ui.py` is executed.
*   It first checks for the `GOOGLE_API_KEY` environment variable. If not found, it displays an error and stops.
*   It then calls `initialize_llm_clients()` from `app/llm_clients.py` to set up the necessary Large Language Model clients. If this fails, an error is displayed.

**2. User Input for New Content Generation:**
*   The UI presents input fields for the English source title, body, source name, and URL.
*   Checkboxes allow the user to select optional content like Instagram texts, story teasers, and an Iranian Farsi video prompt.

**3. (Optional) Loading Previous Work:**
   Users can load previously generated content:
*   **Local File Upload:** Via `st.file_uploader` for JSON files from the `answers/` folder.
*   **Pantry Cloud Loading:** If `PANTRY_ID` is configured, users can fetch and select baskets from Pantry Cloud.

**4. Content Generation Process:**
*   Clicking "âœ¨ Generate Persian Blog Post Package" triggers `generate_persian_blog_package()` from `app/content_generator.py`.
*   This function uses the initialized LLM clients and source details to produce the Persian blog package, SEO metadata, image prompts, etc.
*   **Data Saving (Automatic):** The generated output is saved locally (to `answers/`) and to Pantry Cloud (if configured) by functions in `app/file_utils.py`.

**5. Displaying Generated/Loaded Content:**
*   The UI presents the generated or loaded data in expandable sections (Metadata, Blog Content, Image Prompts, Instagram Content, etc.).

**6. Thumbnail Image Upload (Blog):**
*   Users can upload a thumbnail image, which is saved locally to the `images/` directory in WEBP format.

**7. Publishing to WordPress:**
*   Clicking "Create Draft Post in WordPress" calls `create_draft_post()` from `app/wordpress_handler.py`.
*   This function sends the title, content, slug, tags, SEO metadata, and the locally saved image (if found) to the WordPress REST API to create a draft post.

---

## ğŸ“‹ Requirements

1.  **Software:**
    *   Python 3.11
    *   `uv` package manager (recommended)
    *   WordPress site with REST API & Application Password.
    *   OpenAI-compatible API access or Google AI (Gemini) API access.
    *   (Optional) Custom Rank Math API plugin.
2.  **Environment Setup:**
    *   Create a `.env` file in the project root.
    *   Populate it with:

    ```env
    # LLM Configuration
    GOOGLE_API_KEY=your_google_api_key_for_gemini
    BLOG_MODEL_NAME=choose_your_blog_model
    IMAGE_PROMPT_MODEL_NAME=choose_your_image_prompt_model
    INSTAGRAM_TEXT_MODEL_NAME=choose_your_instagram_text_model

    # WordPress Configuration
    WP_URL=your_wordpress_site_url
    WP_USERNAME=your_wordpress_username
    WP_APP_PASSWORD=your_wordpress_application_password

    # Pantry Cloud (Optional)
    # PANTRY_ID=your_pantry_cloud_id 
    ```
    _Ensure `WP_USERNAME` is set for file/basket naming. If `PANTRY_ID` is provided, cloud features are enabled._

---

## ğŸ’» Installation & Launch Instructions

1.  **Clone Repository**
2.  **Install Dependencies** (Using `uv sync`)
    ```bash
    uv sync
    ```
3.  **Configure Environment** (Create and populate `.env` as described above).
4.  **Launch Application**
    ```bash
    streamlit run app/app.py
    ```
    (Or use `run.bat` on Windows).

---

## ğŸ“ Usage Guide

1.  Launch and access the Streamlit app.
2.  **Input Source:** Fill in English article details.
3.  **Generate Content:** Click "âœ¨ Generate Persian Blog Post Package".
    *   Optionally select/deselect checkboxes for Instagram post/story generation.
4.  **Review Output:** Examine generated content. Outputs are automatically saved locally and to Pantry if configured.
5.  **Upload Thumbnail:** Use the image uploader.
6.  **(Optional) Load Existing Output:**
    *   **Local:** Use the "Upload a previously generated .json file".
    *   **Pantry Cloud:** If configured, use the "Load from Pantry Cloud" section.
7.  **Create WordPress Draft:** Click "ğŸš€ Create Draft Post in WordPress".
8.  **Verify:** Check WordPress admin.

---

## âš™ï¸ Technical Implementation Details

### LLM Usage
*   Uses `langchain-openai`'s `ChatOpenAI` client via `app.llm_clients`.
*   Content generation is orchestrated in `app.content_generator` with detailed prompts.
*   Enhanced prompts include E-E-A-T optimization, semantic keyword integration, and Persian localization.

### WordPress Interaction (`requests`)
*   Managed by `app.wordpress_handler`.
*   Uses `requests` for synchronous communication with WordPress REST API.

### Data Persistence & Cloud Sync (`app.file_utils`, `aiohttp`)
*   `app.file_utils` contains logic for data handling.
*   Local saves: JSON files to `answers/`, prefixed with sanitized `WP_USERNAME`.
*   Pantry Cloud: If `PANTRY_ID` is set, saves to Pantry using `aiohttp` for asynchronous `POST` requests. Basket names are also prefixed with username.
*   Pantry Loading: Lists baskets and fetches content asynchronously using `aiohttp`.

### UI (`streamlit`)
*   Managed by `app.ui` and `app.app`.
*   Uses `asyncio.run` to integrate asynchronous Pantry loading functions into Streamlit's synchronous flow.

### File Handling & Logging
*   Standard Python libraries (`os`, `dotenv`, `logging`, `markdown`, `Pillow`, `mimetypes`).

### SEO & Content Optimization
*   Comprehensive SEO strategies implemented in prompts
*   E-E-A-T optimization for search engine trust
*   Semantic keyword integration with natural language flow
*   Strategic keyword placement and content structure optimization

---

## ğŸ“ˆ Current Status & Future Plans

### Current Status
*   Core workflow functional: LLM generation, local/Pantry saving (with username prefix), loading from local/Pantry, WordPress draft creation.
*   Enhanced SEO optimization with E-E-A-T focus and semantic keyword integration.
*   Persian localization with cultural references and voice search optimization.
*   Minimal, clean image prompt generation for better visual appeal.
*   Pantry operations are asynchronous.
*   Rank Math API integration remains potentially unreliable.
*   Non-ASCII tag creation via API is disabled.

### Future Enhancements
*   Resolving network/SSL errors for WordPress.
*   Improving Rank Math integration.
*   Solution for non-ASCII tags.
*   More robust error handling.
*   Internal linking capabilities.
*   Enhanced testing suite.
*   Performance optimization for large content generation.
*   Additional social media platform integrations.

---
